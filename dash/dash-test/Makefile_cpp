
DASH_ROOT = $(shell pwd)/../..
LIBDASH   = $(DASH_ROOT)/dash-lib/libdash.a

DART_ROOT = $(shell pwd)/../../../dart-impl
LIBDART   = $(DART_ROOT)/shmem/dart-shmem/libdart.a -lpthread

include $(DASH_ROOT)/make.defs

DART_INC  = ../$(DART_IF)/
DASH_INC  = $(DASH_ROOT)/dash-lib/

PWD  = $(shell basename `pwd`)
PAT  = $(shell echo -n $(PWD) )
PROG = $(shell echo -n $(PAT) | cut -d . -f 3)

all : $(LIBDASH) $(PROG)

printenv : 
	 @echo "DASH_ROOT = $(DASH_ROOT)"
	 @echo "LIBDASH   = $(LIBDASH)"
	 @echo "DART_ROOT = $(DART_ROOT)"
	 @echo "LIBDART   = $(LIBDART)"

$(LIBDASH) :
	make -C $(DASH_ROOT)/dash-lib/

$(PROG) : main.o
	$(CXX) $(LFLGAS) -o $@ $+ $(LIBDASH) $(LIBDART)

%.o 	: %.cpp 
	$(CXX) -c $(CFLAGS) -I$(DART_INC) -I$(DASH_INC) $+

clean : 
	rm -f *.o *~
	rm -f $(PROG)
